C51 COMPILER V9.60.0.0   HALLSLIDE                                                         04/20/2023 10:18:56 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE HALLSLIDE
OBJECT MODULE PLACED IN .\Objects\HallSlide.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Softwares\ModuleLogic\HallSlide.c LARGE OMF2 OPTIMIZE(9,SPEED) BROWSE IN
                    -CDIR(.\Drivers\Lib\c;.\Drivers\Lib\H;.\Drivers\Lib\IAP_Lib;.\Drivers\Lib\TouchKey_lib;.\Drivers\Physical;.\Drivers\Proto
                    -col;.\Softwares\Application;.\Softwares\Basic;.\Softwares\ModuleLogic;.\Drivers\Protocol\YC_NFC;.\Drivers\Protocol\WIFI_
                    -Tuya) DEBUG PRINT(.\Listings\HallSlide.lst) TABS(2) OBJECT(.\Objects\HallSlide.obj)

line level    source

   1          #include "Project.h"
   2          #include "global_variable.h"
   3          #include "IO.h"
   4          
   5          #ifdef Function_HallSlide
              #include "LowPower.h"
              
              bit LastHallState = 1;        //正常运行时上次读到霍尔io口的电位值
              bit HallSleepFlag = 0;        //霍尔休眠标志
              bit SleepingHallState = 0;    //休眠时读到霍尔io口的电位值
              
              void HallSlideCover_Init(void)
              {
                LastHallState = PINMACRO_HALLSENSOR_STATUS;
              }
              
              void HallSleep_Task(void)
              {
                if( LastHallState == 0 )
                {
                  if( PINMACRO_HALLSENSOR_STATUS == 1 )
                  {
                    HallSleepFlag = 1;
                  }
                }
                if( HallSleepFlag == 1 )
                {
                  //HallSleepFlag = 0;
                  SystemPowerMgr.SleepDelayTimerCnt = 0x0000;
                }
                LastHallState = PINMACRO_HALLSENSOR_STATUS;
              }
              
              void HallAwakeupDispose(void)
              {
                if( SleepingHallState == 1 )
                {
                  if( PINMACRO_HALLSENSOR_STATUS == 0 )
                  {
                    MX_QuitLowPowerMode();
                  }
                }
                else{
                  if( PINMACRO_HALLSENSOR_STATUS == 1 )
                  {
                    SleepingHallState = 1;
                    LastHallState = 1;
                  }
                }
              }
              
              #endif
C51 COMPILER V9.60.0.0   HALLSLIDE                                                         04/20/2023 10:18:56 PAGE 2   



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
